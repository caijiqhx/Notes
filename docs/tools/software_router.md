# 软路由

> 终于，在校园网的压迫下，我这个懒B也开始搞软路由了

## 配置

开始想买个 r2s/r4s 这种小的能用就行，然后看 youtube 视频发现了 3867u，去咸鱼看了没货，但是在那家店发现了用小主机当软路由的操作。然后就被室友疯狂安利洗脑加需求上了联想 M93p 准系统。

CPU i5-4690T, 2.5GHz, VT-x/VT-d, TDP 45W。看用得比较多的是 i5-4590T, 2.0GHz, TDP 35W，后来看就贵 20 块性能还提升挺多的。T 系列应该就是桌面版的低功耗版本，M93p 这种小主机最高也就能带的起 TDP 35/45W 的了吧，看到网上还有改散热把单热管改成双热管的，反正这个是够用了，懒得折腾。实际使用下来温度也就四五十，把主机放阳台更有利于散热（~~辣鸡宿舍漏风~~）。

正常的这个准系统是单网口的，但是要做软路由，就得改成双网口。咸鱼上一般卖家都提供这种服务，把原来的串口改成 mini-PCIE 转网口，这样就双网口了。自己搞应该是还要搞联想的 BIOS 白名单（~~辣鸡联想~~），我嫌麻烦就让买的卖家搞好的。这种要注意的就是扩展的这个网卡，Realtek 8111 这种螃蟹的网卡比 Intel 210/211 的便宜好几十，一定要问好是哪个。我买的时候问是 Intel 的结果发过来个螃蟹的（~~退差价了~~），不过在日常使用中并没感觉螃蟹的网卡有什么弊端，不用它做 WAN 口就是了。

## PVE

CPU 搞这个强肯定不能只装个 OpenWrt，索性直接搞个虚拟机，以后也用得到。可选的虚拟化平台也没几个：

- ESXi，VMWare 搞的，似乎企业用的多，不过好像有硬件要求，配置太低搞不动。内存我这就一条 8G 的，问就是没钱。
- Proxmox，基于 Debian 的，室友在用这个，本着懒的原则，就这个吧。
- Hyper-V，Windows Server，煞笔校园网 ipv6 有点问题，似乎是不允许用 EUI 方式计算后缀，导致我用 Proxmox+OpenWrt 搞完直接插不能用 ipv6，只能通过骚操作连。搜到了一篇[基于 Windows 的软路由]([[2020-3-15-WIN10-软路由专用完整方案最终版，含说明]Server_2019_x64_软路由版 - 软路由，x86系统，openwrt(x86) 等 - 恩山无线论坛 - Powered by Discuz! (right.com.cn)](https://www.right.com.cn/forum/thread-2800605-1-1.html))的，以后可以折腾一下。

现在就是用 Proxmox，安装就跟装 Linux 一样。